<div class="tests-list-container">
  <div class="tests-header">
    <h2>Доступные тесты</h2>
    <div class="filters">
      <div class="filter-group">
        <label for="topic">Тема:</label>
        <select id="topic" (change)="onTopicChange($event)">
          @for (topic of topics; track topic.value) {
            <option [value]="topic.value">{{ topic.label }}</option>
          }
        </select>
      </div>
      <div class="filter-group">
        <label for="difficulty">Сложность:</label>
        <select id="difficulty" (change)="onDifficultyChange($event)">
          @for (level of difficultyLevels; track level.value) {
            <option [value]="level.value">{{ level.label }}</option>
          }
        </select>
      </div>
    </div>
  </div>

  @if (isLoading) {
    <div class="loading">Загрузка тестов...</div>
  } @else if (errorMessage) {
    <div class="error">{{ errorMessage }}</div>
  } @else {
    <div class="tests-grid">
      @for (test of filteredTests; track test.id) {
        <div class="test-card" [class.completed]="test.isCompleted">
          <div class="test-header">
            <h3>{{ test.title }}</h3>
            @if (test.isCompleted) {
              <span class="completed-badge">Пройден: {{ test.userScore }}%</span>
            }
          </div>
          <div class="test-info">
            <span><strong>Тема:</strong> {{ getTopicName(test.topic) }}</span>
            <span><strong>Сложность:</strong> {{ getDifficultyName(test.difficulty) }}</span>
            <span><strong>Вопросов:</strong> {{ getQuestionCount(test) }}</span>
            <span><strong>Время:</strong> {{ test.timeLimit }} мин</span>
          </div>
          <p class="test-description">{{ test.description }}</p>
          <div class="test-actions">
            @if (test.isCompleted) {
              <button class="btn-retake" (click)="startTest(test.id)">
                Пройти снова
              </button>
            } @else {
              <button class="btn-start" (click)="startTest(test.id)">
                Начать тест
              </button>
            }
          </div>
        </div>
      }
      @if (filteredTests.length === 0) {
        <div class="no-tests">
          <p>Нет доступных тестов по выбранным критериям</p>
        </div>
      }
    </div>
  }
</div>
