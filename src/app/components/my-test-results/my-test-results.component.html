<div class="my-test-results">
  <div class="page-header">
    <h2>üìä –ú–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</h2>
    <p>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤</p>
  </div>

  @if (isLoading) {
    <div class="loading">
      <div class="spinner"></div>
      <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...</p>
    </div>
  } @else if (errorMessage) {
    <div class="error">
      {{ errorMessage }}
    </div>
  } @else if (testResults.length === 0) {
    <div class="no-results">
      <div class="empty-state">
        <div class="empty-icon">üìù</div>
        <h3>–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
        <p>–í—ã –µ—â–µ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Ç–µ—Å—Ç—ã. –ù–∞—á–Ω–∏—Ç–µ —Å –≤—ã–±–æ—Ä–∞ —Ç–µ—Å—Ç–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ "–¢–µ—Å—Ç—ã".</p>
        <a routerLink="/tests" class="btn-primary">
          –ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç–∞–º
        </a>
      </div>
    </div>
  } @else {
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="stats-overview">
      <div class="stat-card">
        <div class="stat-icon">üìä</div>
        <div class="stat-content">
          <div class="stat-value">{{ totalTestsTaken }}</div>
          <div class="stat-label">–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">‚≠ê</div>
        <div class="stat-content">
          <div class="stat-value">{{ averageScore }}%</div>
          <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">üèÜ</div>
        <div class="stat-content">
          <div class="stat-value">{{ bestScore }}%</div>
          <div class="stat-label">–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
        </div>
      </div>
    </div>

    <!-- –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤ -->
    <div class="results-section">
      <h3>–ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤</h3>

      <div class="results-table">
        <table>
          <thead>
            <tr>
              <th>–¢–µ—Å—Ç</th>
              <th>–î–∞—Ç–∞</th>
              <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
              <th>–û—Ü–µ–Ω–∫–∞</th>
              <th>–í—Ä–µ–º—è</th>
            </tr>
          </thead>
          <tbody>
            @for (result of testResults; track result.id) {
              <tr>
                <td class="test-name">
                  <div class="test-title">{{ result.testTitle }}</div>
                </td>
                <td class="test-date">
                  {{ formatDate(result.completedAt) }}
                </td>
                <td class="test-score">
                  <div class="score-container">
                    <div class="score-bar">
                      <div class="score-fill"
                           [style.width.%]="result.score"
                           [style.background-color]="getScoreColor(result.score)"></div>
                    </div>
                    <div class="score-value">
                      {{ result.score }}%
                    </div>
                  </div>
                </td>
                <td class="test-grade">
                  <span class="grade-badge"
                        [style.background-color]="getGradeColor(result.grade)">
                    {{ result.grade }}
                  </span>
                </td>
                <td class="test-time">
                  {{ formatTimeSpent(result.timeSpent) }}
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  }
</div>
