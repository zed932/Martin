<div class="test-management">
  <div class="management-header">
    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞–º–∏</h3>
    <button class="btn-primary" (click)="showAddTestForm = !showAddTestForm">
      {{ showAddTestForm ? '‚úï –û—Ç–º–µ–Ω–∞' : '+ –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç' }}
    </button>
  </div>

  @if (showAddTestForm) {
    <div class="add-test-form">
      <h4>–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∞</h4>
      <form [formGroup]="testForm" (ngSubmit)="createTest()">
        <div class="form-group">
          <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞</label>
          <input type="text" formControlName="title" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞">
        </div>

        <div class="form-group">
          <label>–¢–µ–º–∞</label>
          <select formControlName="topic" class="form-control">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É</option>
            <option value="calculus">–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</option>
            <option value="algebra">–ê–ª–≥–µ–±—Ä–∞</option>
            <option value="geometry">–ì–µ–æ–º–µ—Ç—Ä–∏—è</option>
            <option value="sets">–¢–µ–æ—Ä–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤</option>
            <option value="matrices">–ú–∞—Ç—Ä–∏—Ü—ã</option>
          </select>
        </div>

        <div class="form-group">
          <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
          <textarea formControlName="description" class="form-control" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞"></textarea>
        </div>

        <div class="form-group">
          <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤</label>
          <input type="number" formControlName="questionsCount" class="form-control" min="1" max="50">
        </div>

        <div class="form-group">
          <label>–í—Ä–µ–º—è –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–º–∏–Ω—É—Ç)</label>
          <input type="number" formControlName="timeLimit" class="form-control" min="5" max="180">
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-success" [disabled]="testForm.invalid">
            –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç
          </button>
        </div>
      </form>
    </div>
  }

  <div class="tests-list">
    <h4>–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã</h4>

    @for (test of tests; track test.id) {
      <div class="test-card">
        <div class="test-info">
          <h5>{{ test.title }}</h5>
          <p>{{ test.description }}</p>
          <div class="test-meta">
            <span class="topic-badge">{{ getTopicName(test.topic) }}</span>
            <span>–í–æ–ø—Ä–æ—Å–æ–≤: {{ test.questionsCount }}</span>
            <span>–í—Ä–µ–º—è: {{ test.timeLimit }} –º–∏–Ω</span>
            <span>–°–ª–æ–∂–Ω–æ—Å—Ç—å: {{ test.difficulty }}</span>
          </div>
        </div>
        <div class="test-actions">
          <button class="btn-edit">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
          <button class="btn-delete" (click)="deleteTest(test.id)">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
          <button class="btn-view">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä</button>
        </div>
      </div>
    } @empty {
      <div class="empty-state">
        <p>–ù–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤</p>
      </div>
    }
  </div>
</div>
